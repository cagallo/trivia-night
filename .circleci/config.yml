version: 2.1
jobs:
  deploy:
    executor: heroku/default
    steps:
      - checkout
      - heroku/install
      - run:
          command:
            'git push heroku main'
orbs:
  cypress: cypress-io/cypress@1
  heroku: circleci/heroku@1.2.6
workflows:
    build:
      jobs:
        - cypress/run:
            group: 'all tests' # name this group "all tests" on the dashboard
            start: 'npm start' # start server before running tests
    heroku_deploy:
      jobs:
        - deploy
